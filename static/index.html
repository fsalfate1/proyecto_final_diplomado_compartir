<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Pulso - Tu Salud en tus Manos</title>
  
  <link rel="stylesheet" href="css/variables.css">
  <link rel="stylesheet" href="css/base.css">
  <link rel="stylesheet" href="css/layout.css">
  <link rel="stylesheet" href="css/components.css">

  <!-- Leaflet for Maps -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>わ</text></svg>">
</head>
<body>

  <div class="app-container">
    <header>
      <div class="logo-area">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="heartbeat" style="color: var(--pulso-heart);">
          <path d="M12 21.35l-1.45-1.32C5.4 15.36 2 12.28 2 8.5 2 5.42 4.42 3 7.5 3c1.74 0 3.41.81 4.5 2.09C13.09 3.81 14.76 3 16.5 3 19.58 3 22 5.42 22 8.5c0 3.78-3.4 6.86-8.55 11.54L12 21.35z" fill="currentColor"/>
        </svg>
        <span class="logo-text">Pulso</span>
      </div>
      
      <div class="header-actions">
        <button id="history-btn" class="header-btn" aria-label="Historial de Consultas">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path>
          </svg>
          <span>Historial de Consultas</span>
        </button>

        <button id="location-btn" class="header-btn" aria-label="Ver mi ubicaci贸n">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path>
            <circle cx="12" cy="10" r="3"></circle>
          </svg>
          <span id="location-status">Ubicaci贸n</span>
        </button>
      </div>
    </header>

    <div id="chat-container" class="chat-container">
      <!-- Messages will appear here -->
    </div>

    <!-- Quick Actions (Hidden by default, shown when relevant) -->
    <div id="quick-actions" class="quick-actions" style="padding: 0 var(--spacing-md); display: none;">
      <!-- Chips injected via JS -->
    </div>

    <div class="input-area">
      <textarea id="chat-input" class="chat-input" placeholder="Escribe aqu铆... (ej. dolor de cabeza)" rows="1"></textarea>
      <button id="send-btn" class="send-btn">
        <svg viewBox="0 0 24 24">
          <path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"></path>
        </svg>
      </button>
    </div>
  </div>

  <!-- Map Modal -->
  <div id="map-modal" class="modal-overlay" style="display: none;">
    <div class="modal-content">
      <div class="modal-header">
        <h3> Tu Ubicaci贸n</h3>
        <button id="close-map-btn" class="close-btn">&times;</button>
      </div>
      <div id="map" style="height: 300px; width: 100%; border-radius: var(--radius-sm); margin-bottom: 1rem;"></div>
      <p style="font-size: 0.9rem; color: var(--pulso-ash); margin-bottom: 1rem;">
        Esta es la ubicaci贸n que usaremos para buscar farmacias cercanas.
      </p>
      <button id="confirm-location-btn" class="primary-btn">Confirmar Ubicaci贸n</button>
    </div>
  </div>

  <!-- Terms and Conditions Modal -->
  <div id="terms-overlay" style="position: fixed; inset: 0; background: rgba(255,255,255,0.98); z-index: 101; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 2rem; text-align: center; display: none;">
    <h1 style="font-size: 1.8rem; margin-bottom: 1.5rem; color: var(--pulso-deep);">T茅rminos y Condiciones</h1>
    <div style="background: #f8f9fa; padding: 1.5rem; border-radius: 8px; border: 1px solid #dee2e6; max-width: 500px; max-height: 300px; overflow-y: auto; text-align: left; margin-bottom: 2rem; font-size: 0.95rem; line-height: 1.5; color: var(--pulso-ash);">
      <p><strong>Bienvenido a la Demo de Pulso.</strong></p>
      <p>Antes de continuar, por favor lee y acepta los siguientes t茅rminos:</p>
      <ul style="padding-left: 1.2rem; margin-top: 1rem;">
        <li style="margin-bottom: 0.5rem;">Esta aplicaci贸n es una versi贸n de demostraci贸n (Demo) y se encuentra en fase de pruebas.</li>
        <li style="margin-bottom: 0.5rem;">La informaci贸n proporcionada es referencial y <strong>no constituye consejo m茅dico profesional</strong>.</li>
        <li style="margin-bottom: 0.5rem;">En caso de emergencia de salud real, por favor contacta a los servicios de urgencia correspondientes.</li>
        <li>Tus datos (n煤mero de tel茅fono) se solicitan 煤nicamente para fines de registro en esta demostraci贸n y personalizaci贸n de la experiencia.</li>
      </ul>
    </div>
    <button id="accept-terms-btn" style="background: var(--pulso-heart); color: white; border: none; padding: 1rem 2.5rem; border-radius: 99px; font-size: 1.1rem; cursor: pointer; font-weight: bold; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">Aceptar y Continuar</button>
  </div>

  <!-- Onboarding Modal (Simple Overlay) -->
  <div id="onboarding-overlay" style="position: fixed; inset: 0; background: rgba(255,255,255,0.95); z-index: 100; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 2rem; text-align: center; display: none;">
    <h1 style="font-size: 2rem; margin-bottom: 1rem; color: var(--pulso-heart);">Hola </h1>
    <p style="margin-bottom: 2rem; max-width: 300px;">Soy Pulso. Para darte un mejor servicio, necesito saber tu n煤mero de tel茅fono para guardar tu historial.</p>
    <input type="tel" id="phone-input" placeholder="+569..." style="font-size: 1.2rem; padding: 0.8rem; border-radius: 8px; border: 2px solid var(--pulso-deep); width: 100%; max-width: 300px; margin-bottom: 1rem;">
    <button id="start-btn" style="background: var(--pulso-deep); color: white; border: none; padding: 1rem 2rem; border-radius: 99px; font-size: 1.1rem; cursor: pointer; font-weight: bold;">Comenzar</button>
    <p id="onboarding-error" style="color: var(--pulso-alert); margin-top: 1rem; display: none;"></p>
  </div>

  <script type="module" src="js/chat.js?v=9"></script>
</body>
</html>
